{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Urvi\\\\Documents\\\\INFO6150\\\\MERN-Ecommerce\\\\MERN-Ecommerce\\\\frontend\\\\src\\\\pages\\\\OrderPage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Row, Col, ListGroup, Image, Card, Button } from \"react-bootstrap\";\nimport { Link } from \"react-router-dom\";\nimport { PayPalButton } from \"react-paypal-button-v2\"; // for paypal payments\n\nimport axios from \"axios\";\nimport Message from \"../components/Message\";\nimport Loader from \"../components/Loader\";\nimport { getOrderDetails, payOrder, deliverOrder } from \"../actions/orderActions\";\nimport { ORDER_PAY_RESET, ORDER_DELIVER_RESET } from \"../constants/orderConstants\";\nimport { savePaymentMethod } from \"../actions/cartActions\";\nimport { Elements } from \"@stripe/react-stripe-js\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { refreshLogin } from \"../actions/userActions\";\nimport CheckoutForm from \"../components/CheckoutForm\"; //stripe checkout form\n\nimport getDateString from \"../utils/getDateString\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst OrderPage = ({\n  match,\n  history\n}) => {\n  _s();\n\n  // load stripe\n  const stripePromise = loadStripe(process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY); // for paypal payment\n\n  const [SDKReady, setSDKReady] = useState(false);\n  const dispatch = useDispatch();\n  const orderID = match.params.id;\n  const orderDetails = useSelector(state => state.orderDetails);\n  const {\n    loading,\n    order,\n    error\n  } = orderDetails;\n  const orderPay = useSelector(state => state.orderPay);\n  const {\n    loading: loadingPay,\n    success: successPay\n  } = orderPay;\n  const orderDeliver = useSelector(state => state.orderDeliver);\n  const {\n    loading: loadingDeliver,\n    success: successDeliver\n  } = orderDeliver;\n  const userLogin = useSelector(state => state.userLogin);\n  const {\n    userInfo\n  } = userLogin;\n  const userDetails = useSelector(state => state.userDetails);\n  const {\n    error: userLoginError\n  } = userDetails; // get new access tokens using the refresh token, is user details throws an error\n\n  useEffect(() => {\n    if (userLoginError && userInfo && !userInfo.isSocialLogin) {\n      const user = JSON.parse(localStorage.getItem(\"userInfo\"));\n      user && dispatch(refreshLogin(user.email));\n    }\n  }, [userLoginError, dispatch, userInfo]); // set order to paid or delivered, and fetch updated orders\n\n  useEffect(() => {\n    if (!order || order._id !== orderID || successPay || successDeliver) {\n      if (successPay) dispatch({\n        type: ORDER_PAY_RESET\n      });\n      if (successDeliver) dispatch({\n        type: ORDER_DELIVER_RESET\n      });\n      dispatch(getOrderDetails(orderID));\n    }\n  }, [order, orderID, dispatch, successPay, successDeliver]); // add the script required for paypal payments dynamically, to avoid possible attacks\n\n  useEffect(() => {\n    const addScript = async () => {\n      const config = userInfo.isSocialLogin ? {\n        headers: {\n          Authorization: `SocialLogin ${userInfo.id}`\n        }\n      } : {\n        headers: {\n          Authorization: `Bearer ${userInfo.accessToken}`\n        }\n      };\n      const {\n        data: clientID\n      } = await axios.get(\"/api/config/paypal\", config); // add the script\n\n      const script = document.createElement(\"script\");\n      script.async = true;\n      script.type = \"text/javascript\";\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientID}&currency=USD&disable-funding=credit,card`;\n\n      script.onload = () => setSDKReady(true);\n\n      document.body.appendChild(script);\n    };\n\n    if (!userInfo) history.push(\"/login\"); // if not loggein in\n\n    if (!SDKReady) addScript();\n  }, [userInfo, SDKReady, history]); // save the payment mthod as paypal\n\n  const successPaymentHandler = paymentResult => {\n    dispatch(savePaymentMethod(\"PayPal\"));\n    dispatch(payOrder(orderID, { ...paymentResult,\n      paymentMode: \"paypal\"\n    }));\n  }; // set order as delivered\n\n\n  const successDeliveryHandler = () => {\n    dispatch(deliverOrder(orderID));\n  };\n\n  return loading ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 5\n  }, this) : error ? /*#__PURE__*/_jsxDEV(Message, {\n    dismissible: true,\n    variant: \"danger\",\n    duration: 10,\n    children: error\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 5\n  }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [\"Order \", orderID]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: loading ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          md: 8,\n          children: /*#__PURE__*/_jsxDEV(ListGroup, {\n            variant: \"flush\",\n            children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"Shipping\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Name: \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 124,\n                  columnNumber: 21\n                }, this), order.user.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 123,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Email: \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 128,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n                  href: `mailto:${order.user.email}`,\n                  children: order.user.email\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 129,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Address: \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 134,\n                  columnNumber: 21\n                }, this), \" \", order.shippingAddress.address, \",\", \" \", order.shippingAddress.city, \"-\", order.shippingAddress.postalCode, \",\", \" \", order.shippingAddress.country]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 133,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: order.isDelivered ? /*#__PURE__*/_jsxDEV(Message, {\n                  variant: \"success\",\n                  children: [\"Delivered at: \", getDateString(order.deliveredAt)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 141,\n                  columnNumber: 23\n                }, this) : /*#__PURE__*/_jsxDEV(Message, {\n                  variant: \"danger\",\n                  children: \"Not Delivered\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 145,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"Payment Method\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Method: \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 152,\n                  columnNumber: 21\n                }, this), \" \", order.paymentMethod]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: order.isPaid ? /*#__PURE__*/_jsxDEV(Message, {\n                  variant: \"success\",\n                  children: [\"Paid at: \", getDateString(order.paidAt)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 23\n                }, this) : /*#__PURE__*/_jsxDEV(Message, {\n                  variant: \"danger\",\n                  children: \"Not Paid\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 160,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 154,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"Cart Items\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 19\n              }, this), order.orderItems.length !== 0 ? /*#__PURE__*/_jsxDEV(ListGroup, {\n                variant: \"flush\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    background: \"red\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 168,\n                  columnNumber: 23\n                }, this), order.orderItems.map((item, idx) => /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                  children: /*#__PURE__*/_jsxDEV(Row, {\n                    children: [/*#__PURE__*/_jsxDEV(Col, {\n                      md: 2,\n                      children: /*#__PURE__*/_jsxDEV(Image, {\n                        className: \"product-image\",\n                        src: item.image,\n                        alt: item.name,\n                        fluid: true,\n                        rounded: true\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 177,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 176,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(Col, {\n                      children: /*#__PURE__*/_jsxDEV(Link, {\n                        to: `/product/${item.product}`,\n                        children: item.name\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 186,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 185,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(Col, {\n                      md: 4,\n                      children: [item.qty, \" x \", item.price, \" =\", \" \", (item.qty * item.price).toLocaleString(\"en-IN\", {\n                        maximumFractionDigits: 2,\n                        style: \"currency\",\n                        currency: \"USD\"\n                      })]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 190,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 175,\n                    columnNumber: 27\n                  }, this)\n                }, idx, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 25\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(Message, {\n                children: \"No order\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 4,\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            children: /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(\"h2\", {\n                  className: \"text-center\",\n                  children: \"Order Summary\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 19\n              }, this), error && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Message, {\n                  dismissible: true,\n                  variant: \"danger\",\n                  duration: 10,\n                  children: error\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 216,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Subtotal\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 224,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 223,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: order.itemsPrice.toLocaleString(\"en-IN\", {\n                      maximumFractionDigits: 2,\n                      style: \"currency\",\n                      currency: \"USD\"\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 226,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 222,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 221,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Shipping\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 238,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 237,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: order.shippingPrice.toLocaleString(\"en-IN\", {\n                      maximumFractionDigits: 2,\n                      style: \"currency\",\n                      currency: \"USD\"\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 240,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Tax\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 252,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 251,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: order.taxPrice.toLocaleString(\"en-IN\", {\n                      maximumFractionDigits: 2,\n                      style: \"currency\",\n                      currency: \"USD\"\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 254,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 250,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 249,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Total\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 266,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 265,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: order.totalPrice.toLocaleString(\"en-IN\", {\n                      maximumFractionDigits: 2,\n                      style: \"currency\",\n                      currency: \"USD\"\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 268,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 264,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 263,\n                columnNumber: 19\n              }, this), !order.isPaid && /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: order.paymentMethod === \"PayPal\" ? /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                  children: [loadingPay && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 282,\n                    columnNumber: 42\n                  }, this), !SDKReady ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 284,\n                    columnNumber: 29\n                  }, this) : /*#__PURE__*/_jsxDEV(PayPalButton, {\n                    style: {\n                      shape: \"rect\",\n                      color: \"gold\",\n                      layout: \"vertical\",\n                      label: \"pay\"\n                    },\n                    currency: \"USD\",\n                    amount: Number(order.totalPrice / 1).toFixed(2),\n                    onSuccess: successPaymentHandler\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 286,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 25\n                }, this) : /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                  children: [loadingPay && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 301,\n                    columnNumber: 42\n                  }, this), /*#__PURE__*/_jsxDEV(Elements, {\n                    stripe: stripePromise,\n                    children: /*#__PURE__*/_jsxDEV(CheckoutForm, {\n                      price: order.totalPrice * 100,\n                      orderID: orderID\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 304,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 302,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 300,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false), userInfo && userInfo.isAdmin && order.isPaid && !order.isDelivered && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: [loadingDeliver && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 319,\n                  columnNumber: 44\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-grid\",\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    type: \"button\",\n                    variant: \"info\",\n                    size: \"lg\",\n                    onClick: successDeliveryHandler,\n                    children: \"Mark as Delivered\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 321,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 320,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 318,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(OrderPage, \"Ko61YobrG4obl3IDG9Gxs4ErQDM=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = OrderPage;\nexport default OrderPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderPage\");","map":{"version":3,"sources":["C:/Users/Urvi/Documents/INFO6150/MERN-Ecommerce/MERN-Ecommerce/frontend/src/pages/OrderPage.js"],"names":["React","useState","useEffect","useDispatch","useSelector","Row","Col","ListGroup","Image","Card","Button","Link","PayPalButton","axios","Message","Loader","getOrderDetails","payOrder","deliverOrder","ORDER_PAY_RESET","ORDER_DELIVER_RESET","savePaymentMethod","Elements","loadStripe","refreshLogin","CheckoutForm","getDateString","OrderPage","match","history","stripePromise","process","env","REACT_APP_STRIPE_PUBLISHABLE_KEY","SDKReady","setSDKReady","dispatch","orderID","params","id","orderDetails","state","loading","order","error","orderPay","loadingPay","success","successPay","orderDeliver","loadingDeliver","successDeliver","userLogin","userInfo","userDetails","userLoginError","isSocialLogin","user","JSON","parse","localStorage","getItem","email","_id","type","addScript","config","headers","Authorization","accessToken","data","clientID","get","script","document","createElement","async","src","onload","body","appendChild","push","successPaymentHandler","paymentResult","paymentMode","successDeliveryHandler","name","shippingAddress","address","city","postalCode","country","isDelivered","deliveredAt","paymentMethod","isPaid","paidAt","orderItems","length","background","map","item","idx","image","product","qty","price","toLocaleString","maximumFractionDigits","style","currency","itemsPrice","shippingPrice","taxPrice","totalPrice","shape","color","layout","label","Number","toFixed","isAdmin"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Row, Col, ListGroup, Image, Card, Button } from \"react-bootstrap\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { PayPalButton } from \"react-paypal-button-v2\"; // for paypal payments\r\nimport axios from \"axios\";\r\nimport Message from \"../components/Message\";\r\nimport Loader from \"../components/Loader\";\r\nimport {\r\n  getOrderDetails,\r\n  payOrder,\r\n  deliverOrder,\r\n} from \"../actions/orderActions\";\r\nimport {\r\n  ORDER_PAY_RESET,\r\n  ORDER_DELIVER_RESET,\r\n} from \"../constants/orderConstants\";\r\nimport { savePaymentMethod } from \"../actions/cartActions\";\r\nimport { Elements } from \"@stripe/react-stripe-js\";\r\nimport { loadStripe } from \"@stripe/stripe-js\";\r\nimport { refreshLogin } from \"../actions/userActions\";\r\nimport CheckoutForm from \"../components/CheckoutForm\"; //stripe checkout form\r\nimport getDateString from \"../utils/getDateString\";\r\n\r\nconst OrderPage = ({ match, history }) => {\r\n  // load stripe\r\n  const stripePromise = loadStripe(\r\n    process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY\r\n  );\r\n  // for paypal payment\r\n  const [SDKReady, setSDKReady] = useState(false);\r\n  const dispatch = useDispatch();\r\n  const orderID = match.params.id;\r\n\r\n  const orderDetails = useSelector((state) => state.orderDetails);\r\n  const { loading, order, error } = orderDetails;\r\n\r\n  const orderPay = useSelector((state) => state.orderPay);\r\n  const { loading: loadingPay, success: successPay } = orderPay;\r\n\r\n  const orderDeliver = useSelector((state) => state.orderDeliver);\r\n  const { loading: loadingDeliver, success: successDeliver } = orderDeliver;\r\n\r\n  const userLogin = useSelector((state) => state.userLogin);\r\n  const { userInfo } = userLogin;\r\n\r\n  const userDetails = useSelector((state) => state.userDetails);\r\n  const { error: userLoginError } = userDetails;\r\n\r\n  // get new access tokens using the refresh token, is user details throws an error\r\n  useEffect(() => {\r\n    if (userLoginError && userInfo && !userInfo.isSocialLogin) {\r\n      const user = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n      user && dispatch(refreshLogin(user.email));\r\n    }\r\n  }, [userLoginError, dispatch, userInfo]);\r\n\r\n  // set order to paid or delivered, and fetch updated orders\r\n  useEffect(() => {\r\n    if (!order || order._id !== orderID || successPay || successDeliver) {\r\n      if (successPay) dispatch({ type: ORDER_PAY_RESET });\r\n      if (successDeliver) dispatch({ type: ORDER_DELIVER_RESET });\r\n      dispatch(getOrderDetails(orderID));\r\n    }\r\n  }, [order, orderID, dispatch, successPay, successDeliver]);\r\n\r\n  // add the script required for paypal payments dynamically, to avoid possible attacks\r\n  useEffect(() => {\r\n    const addScript = async () => {\r\n      const config = userInfo.isSocialLogin\r\n        ? {\r\n            headers: {\r\n              Authorization: `SocialLogin ${userInfo.id}`,\r\n            },\r\n          }\r\n        : {\r\n            headers: {\r\n              Authorization: `Bearer ${userInfo.accessToken}`,\r\n            },\r\n          };\r\n      const { data: clientID } = await axios.get(\"/api/config/paypal\", config);\r\n      // add the script\r\n      const script = document.createElement(\"script\");\r\n      script.async = true;\r\n      script.type = \"text/javascript\";\r\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientID}&currency=USD&disable-funding=credit,card`;\r\n      script.onload = () => setSDKReady(true);\r\n      document.body.appendChild(script);\r\n    };\r\n    if (!userInfo) history.push(\"/login\"); // if not loggein in\r\n    if (!SDKReady) addScript();\r\n  }, [userInfo, SDKReady, history]);\r\n\r\n  // save the payment mthod as paypal\r\n  const successPaymentHandler = (paymentResult) => {\r\n    dispatch(savePaymentMethod(\"PayPal\"));\r\n    dispatch(payOrder(orderID, { ...paymentResult, paymentMode: \"paypal\" }));\r\n  };\r\n\r\n  // set order as delivered\r\n  const successDeliveryHandler = () => {\r\n    dispatch(deliverOrder(orderID));\r\n  };\r\n\r\n  return loading ? (\r\n    <Loader />\r\n  ) : error ? (\r\n    <Message dismissible variant=\"danger\" duration={10}>\r\n      {error}\r\n    </Message>\r\n  ) : (\r\n    <>\r\n      <h2>Order {orderID}</h2>\r\n      <Row>\r\n        {loading ? (\r\n          <Loader />\r\n        ) : (\r\n          <>\r\n            <Col md={8}>\r\n              <ListGroup variant=\"flush\">\r\n                <ListGroup.Item>\r\n                  <h2>Shipping</h2>\r\n                  <p>\r\n                    <strong>Name: </strong>\r\n                    {order.user.name}\r\n                  </p>\r\n                  <p>\r\n                    <strong>Email: </strong>\r\n                    <a href={`mailto:${order.user.email}`}>\r\n                      {order.user.email}\r\n                    </a>\r\n                  </p>\r\n                  <p>\r\n                    <strong>Address: </strong> {order.shippingAddress.address},{\" \"}\r\n                    {order.shippingAddress.city}-\r\n                    {order.shippingAddress.postalCode},{\" \"}\r\n                    {order.shippingAddress.country}\r\n                  </p>\r\n                  <div>\r\n                    {order.isDelivered ? (\r\n                      <Message variant=\"success\">\r\n                        Delivered at: {getDateString(order.deliveredAt)}\r\n                      </Message>\r\n                    ) : (\r\n                      <Message variant=\"danger\">Not Delivered</Message>\r\n                    )}\r\n                  </div>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <h2>Payment Method</h2>\r\n                  <p>\r\n                    <strong>Method: </strong> {order.paymentMethod}\r\n                  </p>\r\n                  <div>\r\n                    {order.isPaid ? (\r\n                      <Message variant=\"success\">\r\n                        Paid at: {getDateString(order.paidAt)}\r\n                      </Message>\r\n                    ) : (\r\n                      <Message variant=\"danger\">Not Paid</Message>\r\n                    )}\r\n                  </div>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <h2>Cart Items</h2>\r\n                  {order.orderItems.length !== 0 ? (\r\n                    <ListGroup variant=\"flush\">\r\n                      <div\r\n                        style={{\r\n                          background: \"red\",\r\n                        }}\r\n                      ></div>\r\n                      {order.orderItems.map((item, idx) => (\r\n                        <ListGroup.Item key={idx}>\r\n                          <Row>\r\n                            <Col md={2}>\r\n                              <Image\r\n                                className=\"product-image\"\r\n                                src={item.image}\r\n                                alt={item.name}\r\n                                fluid\r\n                                rounded\r\n                              />\r\n                            </Col>\r\n                            <Col>\r\n                              <Link to={`/product/${item.product}`}>\r\n                                {item.name}\r\n                              </Link>\r\n                            </Col>\r\n                            <Col md={4}>\r\n                              {item.qty} x {item.price} ={\" \"}\r\n                              {(item.qty * item.price).toLocaleString(\"en-IN\", {\r\n                                maximumFractionDigits: 2,\r\n                                style: \"currency\",\r\n                                currency: \"USD\",\r\n                              })}\r\n                            </Col>\r\n                          </Row>\r\n                        </ListGroup.Item>\r\n                      ))}\r\n                    </ListGroup>\r\n                  ) : (\r\n                    <Message>No order</Message>\r\n                  )}\r\n                </ListGroup.Item>\r\n              </ListGroup>\r\n            </Col>\r\n            <Col md={4}>\r\n              <Card>\r\n                <ListGroup variant=\"flush\">\r\n                  <ListGroup.Item>\r\n                    <h2 className=\"text-center\">Order Summary</h2>\r\n                  </ListGroup.Item>\r\n                  {error && (\r\n                    <ListGroup.Item>\r\n                      <Message dismissible variant=\"danger\" duration={10}>\r\n                        {error}\r\n                      </Message>\r\n                    </ListGroup.Item>\r\n                  )}\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>\r\n                        <strong>Subtotal</strong>\r\n                      </Col>\r\n                      <Col>\r\n                        {order.itemsPrice.toLocaleString(\"en-IN\", {\r\n                          maximumFractionDigits: 2,\r\n                          style: \"currency\",\r\n                          currency: \"USD\",\r\n                        })}\r\n                      </Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>\r\n                        <strong>Shipping</strong>\r\n                      </Col>\r\n                      <Col>\r\n                        {order.shippingPrice.toLocaleString(\"en-IN\", {\r\n                          maximumFractionDigits: 2,\r\n                          style: \"currency\",\r\n                          currency: \"USD\",\r\n                        })}\r\n                      </Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>\r\n                        <strong>Tax</strong>\r\n                      </Col>\r\n                      <Col>\r\n                        {order.taxPrice.toLocaleString(\"en-IN\", {\r\n                          maximumFractionDigits: 2,\r\n                          style: \"currency\",\r\n                          currency: \"USD\",\r\n                        })}\r\n                      </Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>\r\n                        <strong>Total</strong>\r\n                      </Col>\r\n                      <Col>\r\n                        {order.totalPrice.toLocaleString(\"en-IN\", {\r\n                          maximumFractionDigits: 2,\r\n                          style: \"currency\",\r\n                          currency: \"USD\",\r\n                        })}\r\n                      </Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                  {/* show paypal button or the stripe checkout form */}\r\n                  {!order.isPaid && (\r\n                    <>\r\n                      {order.paymentMethod === \"PayPal\" ? (\r\n                        <ListGroup.Item>\r\n                          {loadingPay && <Loader />}\r\n                          {!SDKReady ? (\r\n                            <Loader />\r\n                          ) : (\r\n                            <PayPalButton\r\n                              style={{\r\n                                shape: \"rect\",\r\n                                color: \"gold\",\r\n                                layout: \"vertical\",\r\n                                label: \"pay\",\r\n                              }}\r\n                              currency=\"USD\"\r\n                              amount={Number(order.totalPrice / 1).toFixed(2)}\r\n                              onSuccess={successPaymentHandler}\r\n                            />\r\n                          )}\r\n                        </ListGroup.Item>\r\n                      ) : (\r\n                        <ListGroup.Item>\r\n                          {loadingPay && <Loader />}\r\n                          <Elements stripe={stripePromise}>\r\n                            {/* price in paisa */}\r\n                            <CheckoutForm\r\n                              price={order.totalPrice * 100}\r\n                              orderID={orderID}\r\n                            />\r\n                          </Elements>\r\n                        </ListGroup.Item>\r\n                      )}\r\n                    </>\r\n                  )}\r\n                  {/* show this only to admins, after payment is done */}\r\n                  {userInfo &&\r\n                    userInfo.isAdmin &&\r\n                    order.isPaid &&\r\n                    !order.isDelivered && (\r\n                      <ListGroup.Item>\r\n                        {loadingDeliver && <Loader />}\r\n                        <div className=\"d-grid\">\r\n                          <Button\r\n                            type=\"button\"\r\n                            variant=\"info\"\r\n                            size=\"lg\"\r\n                            onClick={successDeliveryHandler}\r\n                          >\r\n                            Mark as Delivered\r\n                          </Button>\r\n                        </div>\r\n                      </ListGroup.Item>\r\n                    )}\r\n                </ListGroup>\r\n              </Card>\r\n            </Col>\r\n          </>\r\n        )}\r\n      </Row>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default OrderPage;\r\n"]},"metadata":{},"sourceType":"module"}