{"ast":null,"code":"import _asyncToGenerator from\"/Users/riddhibhatti/Webdesign/WebDFinalProject/WebDesigning_FinalProject/TheStyleStudio/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/Users/riddhibhatti/Webdesign/WebDFinalProject/WebDesigning_FinalProject/TheStyleStudio/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/riddhibhatti/Webdesign/WebDFinalProject/WebDesigning_FinalProject/TheStyleStudio/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/riddhibhatti/Webdesign/WebDFinalProject/WebDesigning_FinalProject/TheStyleStudio/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect,useRef}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import{Link}from\"react-router-dom\";import{Form,Button,Row,InputGroup,Col,Card,Table,Image,FloatingLabel}from\"react-bootstrap\";import{LinkContainer}from\"react-router-bootstrap\";import Loader from\"../components/Loader\";import Message from\"../components/Message\";import{sendVerficationEmail,getUserDetails,updateUserProfile,refreshLogin}from\"../actions/userActions\";import{listMyOrders}from\"../actions/orderActions\";import{USER_PROFILE_UPDATE_RESET}from\"../constants/userConstants\";import Meta from\"../components/Meta\";import axios from\"axios\";import getDateString from\"../utils/getDateString\";import\"../styles/profile-page.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ProfilePage=function ProfilePage(_ref){var history=_ref.history;var inputFile=useRef(null);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showSubmitButton=_useState2[0],setShowSubmitButton=_useState2[1];// sisable the submit button unless some user detail is changed by user\nvar _useState3=useState(\"password\"),_useState4=_slicedToArray(_useState3,2),typePassword=_useState4[0],setTypePassword=_useState4[1];var _useState5=useState(\"password\"),_useState6=_slicedToArray(_useState5,2),typeConfirmPassword=_useState6[0],setTypeConfirmPassword=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),name=_useState8[0],setName=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),email=_useState10[0],setEmail=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),avatar=_useState12[0],setAvatar=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),password=_useState14[0],setPassword=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),confirmPassword=_useState16[0],setConfirmPassword=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),message=_useState18[0],setMessage=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),allOrders=_useState20[0],setAllOrders=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),uploading=_useState22[0],setUploading=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),errorImageUpload=_useState24[0],setErrorImageUpload=_useState24[1];var dispatch=useDispatch();var userDetails=useSelector(function(state){return state.userDetails;});var loading=userDetails.loading,user=userDetails.user,error=userDetails.error;var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;var userProfileUpdate=useSelector(function(state){return state.userProfileUpdate;});var success=userProfileUpdate.success;var orderListUser=useSelector(function(state){return state.orderListUser;});var loadingOrdersList=orderListUser.loading,orders=orderListUser.orders,errorOrdersList=orderListUser.error;// check whether verification email has to be sent\nvar userSendEmailVerfication=useSelector(function(state){return state.userSendEmailVerfication;});var emailSent=userSendEmailVerfication.emailSent,hasError=userSendEmailVerfication.hasError;// refresh access token for user details error\nuseEffect(function(){if(error&&userInfo&&!userInfo.isSocialLogin){var _user=JSON.parse(localStorage.getItem(\"userInfo\"));_user&&dispatch(refreshLogin(_user.email));}},[error,dispatch,userInfo]);// set orders to local state\nuseEffect(function(){if(orders&&orders.length){setAllOrders(_toConsumableArray(orders));}},[orders]);// check if any of the input fields value is changed, only then show the submit button\nuseEffect(function(){if(userInfo){if(name&&userInfo.name!==name)setShowSubmitButton(true);else if(email&&userInfo.email!==email)setShowSubmitButton(true);else if(password||confirmPassword)setShowSubmitButton(true);else setShowSubmitButton(false);}},[name,email,password,confirmPassword,userInfo]);useEffect(function(){dispatch(listMyOrders());},[dispatch]);useEffect(function(){if(!userInfo){history.push(\"/login\");}else{// if user is null, first fetch it and then set its details to the local state\nif(!user||!user.name||success){dispatch(listMyOrders());dispatch({type:USER_PROFILE_UPDATE_RESET});userInfo?userInfo.isSocialLogin?dispatch(getUserDetails(userInfo.id)):dispatch(getUserDetails(\"profile\")):dispatch(getUserDetails(\"profile\"));if(success){userInfo.isSocialLogin?dispatch(getUserDetails(userInfo.id)):dispatch(getUserDetails(\"profile\"));}}else{setName(user.name);setEmail(user.email);setAvatar(user.avatar);}}},[history,userInfo,user,dispatch,success,loadingOrdersList]);var showHidePassword=function showHidePassword(e){e.preventDefault();e.stopPropagation();setTypePassword(typePassword===\"password\"?\"text\":\"password\");};var showHideConfirmPassword=function showHideConfirmPassword(e){e.preventDefault();e.stopPropagation();setTypeConfirmPassword(typeConfirmPassword===\"password\"?\"text\":\"password\");};// handle file upload to aws bucket\nvar handleImageUpload=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var file,formData,config,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:file=e.target.files[0];formData=new FormData();formData.append(\"image\",file);setUploading(true);_context.prev=4;config={headers:{\"Content-Type\":\"multipart/form-data\"}};_context.next=8;return axios.post(\"/api/upload\",formData,config);case 8:_yield$axios$post=_context.sent;data=_yield$axios$post.data;setAvatar(data);dispatch(updateUserProfile({id:user.id,avatar:data}));setUploading(false);_context.next=19;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](4);setErrorImageUpload(\"Please choose a valid image\");setUploading(false);case 19:case\"end\":return _context.stop();}}},_callee,null,[[4,15]]);}));return function handleImageUpload(_x){return _ref2.apply(this,arguments);};}();// handle image overlay div's click to upload new file\nvar handleImageClick=function handleImageClick(){inputFile.current.click();};// update user details\nvar handleSubmit=function handleSubmit(e){e.preventDefault();if(password!==confirmPassword){setMessage(\"Passwords do not match. Please retry.\");}else{dispatch(updateUserProfile({id:user.id,name:name,email:email,avatar:avatar,password:password,confirmPassword:confirmPassword}));}};return/*#__PURE__*/_jsxs(Row,{className:\"mt-2\",children:[/*#__PURE__*/_jsx(Meta,{title:\"My Profile | The Style Studio\"}),userInfo&&!userInfo.isConfirmed?/*#__PURE__*/_jsxs(_Fragment,{children:[emailSent&&/*#__PURE__*/_jsx(Message,{variant:\"success\",dismissible:true,children:\"A verification link has been sent your mail!\"}),hasError&&/*#__PURE__*/_jsx(Message,{dismissible:true,variant:\"danger\",children:hasError}),/*#__PURE__*/_jsx(Card,{style:{margin:\"0\"},className:\"mb-3\",children:/*#__PURE__*/_jsxs(Card.Body,{className:\"ps-0 \",children:[/*#__PURE__*/_jsx(Card.Title,{style:{fontWeight:\"bold\"},children:\"Account Not Verified\"}),/*#__PURE__*/_jsxs(Card.Text,{children:[\"\".concat(userInfo.name,\", \"),\" your account is not yet verfied. Please\",\" \",/*#__PURE__*/_jsx(Button,{variant:\"link\",className:\"p-0\",style:{fontSize:\"0.9em\",margin:\"0 0 0.1em 0\",focus:\"none\"},onClick:function onClick(){return dispatch(sendVerficationEmail(userInfo.email));},children:\"click here\"}),\" \",\"to send a verfication email.\"]})]})})]}):null,/*#__PURE__*/_jsxs(Col,{md:3,style:userInfo&&!userInfo.isConfirmed?{opacity:\"0.5\",pointerEvents:\"none\"}:{opacity:\"1\",pointerEvents:\"\"},children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center\",children:\"My Profile\"}),message&&/*#__PURE__*/_jsx(Message,{dismissible:true,variant:\"warning\",duration:8,children:message}),error&&error!==\"Not authorised. Token failed\"&&/*#__PURE__*/_jsx(Message,{dismissible:true,variant:\"danger\",duration:10,children:error}),success&&/*#__PURE__*/_jsx(Message,{dismissible:true,variant:\"success\",duration:8,children:\"Profile Updated!\"}),loading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexFlow:\"column nowrap\"},children:[errorImageUpload&&/*#__PURE__*/_jsx(Message,{dismissible:true,variant:\"danger\",duration:10,children:errorImageUpload}),uploading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(\"div\",{className:\"profile-page-image\",style:{alignSelf:\"center\"},children:[/*#__PURE__*/_jsx(Image,{src:avatar,alt:name,style:{height:\"5em\",width:\"5em\",marginBottom:\"1em\",border:\"1px solid #ced4da\",borderRadius:\"50%\",cursor:\"pointer\"}}),/*#__PURE__*/_jsx(\"div\",{className:\"image-overlay\",onClick:handleImageClick,children:\"Click to upload image\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",id:\"file\",ref:inputFile,onChange:handleImageUpload,style:{display:\"none\"}}),/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(Form.Group,{controlId:\"name\",children:/*#__PURE__*/_jsx(FloatingLabel,{controlId:\"nameinput\",label:\"Name\",className:\"mb-3\",children:/*#__PURE__*/_jsx(Form.Control,{size:\"lg\",placeholder:\"Enter Name\",type:\"text\",value:name,onChange:function onChange(e){return setName(e.target.value);}})})}),/*#__PURE__*/_jsx(Form.Group,{controlId:\"email\",className:\"my-2\",style:userInfo&&userInfo.isSocialLogin?{pointerEvents:\"none\",opacity:\"0.8\"}:{},children:/*#__PURE__*/_jsx(FloatingLabel,{controlId:\"emailinput\",label:\"Email\",className:\"mb-3\",children:/*#__PURE__*/_jsx(Form.Control,{size:\"lg\",placeholder:\"Enter Email Address\",type:\"email\",value:email,onChange:function onChange(e){return setEmail(e.target.value);}})})}),userInfo&&!userInfo.isSocialLogin&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Form.Group,{children:/*#__PURE__*/_jsx(InputGroup,{className:\"d-block\",children:/*#__PURE__*/_jsxs(FloatingLabel,{controlId:\"passwordinput\",label:\"Password\",style:{display:\"flex\"},className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Control,{size:\"lg\",type:typePassword,placeholder:\"Enter your password\",value:password,style:{borderRight:\"none\",width:\"100%\"},onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group-append\",children:/*#__PURE__*/_jsx(InputGroup.Text,{onClick:showHidePassword,style:{fontSize:\"1rem\",height:\"100%\",marginLeft:\"-0.5em\",background:\"transparent\",borderLeft:\"none\"},children:typePassword===\"text\"?/*#__PURE__*/_jsx(\"i\",{className:\"far fa-eye-slash\"}):/*#__PURE__*/_jsx(\"i\",{className:\"far fa-eye\"})})})]})})}),/*#__PURE__*/_jsx(Form.Group,{children:/*#__PURE__*/_jsx(InputGroup,{className:\"d-block\",children:/*#__PURE__*/_jsxs(FloatingLabel,{controlId:\"confirmpasswordinput\",label:\"Confirm Password\",style:{display:\"flex\"},className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Control,{size:\"lg\",type:typeConfirmPassword,placeholder:\"Confirm password\",value:confirmPassword,style:{borderRight:\"none\"},onChange:function onChange(e){return setConfirmPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group-append\",children:/*#__PURE__*/_jsx(InputGroup.Text,{onClick:showHideConfirmPassword,style:{fontSize:\"1rem\",height:\"100%\",marginLeft:\"-0.5em\",background:\"transparent\",borderLeft:\"none\"},children:typeConfirmPassword===\"text\"?/*#__PURE__*/_jsx(\"i\",{className:\"far fa-eye-slash\"}):/*#__PURE__*/_jsx(\"i\",{className:\"far fa-eye\"})})})]})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-grid mb-3\",children:/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:!showSubmitButton,style:{padding:\"0.5em 1em\"},children:\"Update Profile\"})})]})]})]}),/*#__PURE__*/_jsx(Col,{md:9,style:userInfo&&!userInfo.isConfirmed?{opacity:\"0.5\",pointerEvents:\"none\"}:{opacity:\"1\",pointerEvents:\"\"},children:allOrders.length?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center\",children:\"My Orders\"}),loadingOrdersList?/*#__PURE__*/_jsx(Loader,{}):errorOrdersList?/*#__PURE__*/_jsx(Message,{dismissible:true,variant:\"danger\",duration:10,children:errorOrdersList}):/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,responsive:true,className:\"table-sm text-center\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"DATE\"}),/*#__PURE__*/_jsx(\"th\",{children:\"TOTAL\"}),/*#__PURE__*/_jsx(\"th\",{children:\"PAID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"DELIVERED\"}),/*#__PURE__*/_jsx(\"th\",{children:\"ACTION\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:orders.map(function(order,idx){return/*#__PURE__*/_jsxs(\"tr\",{style:{textAlign:\"center\",padding:\"0\"},children:[/*#__PURE__*/_jsx(\"td\",{children:getDateString(order.createdAt)}),/*#__PURE__*/_jsx(\"td\",{children:order.totalPrice.toLocaleString(\"en-US\",{maximumFractionDigits:0,style:\"currency\",currency:\"USD\"})}),/*#__PURE__*/_jsx(\"td\",{children:order.isPaid?getDateString(order.paidAt):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\",style:{color:\"red\"}})}),/*#__PURE__*/_jsx(\"td\",{children:order.isDelivered?getDateString(order.deliveredAt):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\",style:{color:\"red\"}})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(LinkContainer,{to:\"/order/\".concat(order._id),children:/*#__PURE__*/_jsx(Button,{variant:\"link\",className:\"btn-sm\",style:{margin:\"0\"},children:\"Details\"})})})]},idx);})})]})]}):/*#__PURE__*/_jsx(Card,{style:{border:\"none\",margin:\"0 auto\"},children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:\"No Orders Yet!\"}),/*#__PURE__*/_jsxs(Card.Text,{children:[\"Details about all your orders will show up here.\",\" \",/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"Continue Shopping\"})]})]})})})]});};export default ProfilePage;","map":{"version":3,"sources":["/Users/riddhibhatti/Webdesign/WebDFinalProject/WebDesigning_FinalProject/TheStyleStudio/frontend/src/pages/ProfilePage.js"],"names":["React","useState","useEffect","useRef","useSelector","useDispatch","Link","Form","Button","Row","InputGroup","Col","Card","Table","Image","FloatingLabel","LinkContainer","Loader","Message","sendVerficationEmail","getUserDetails","updateUserProfile","refreshLogin","listMyOrders","USER_PROFILE_UPDATE_RESET","Meta","axios","getDateString","ProfilePage","history","inputFile","showSubmitButton","setShowSubmitButton","typePassword","setTypePassword","typeConfirmPassword","setTypeConfirmPassword","name","setName","email","setEmail","avatar","setAvatar","password","setPassword","confirmPassword","setConfirmPassword","message","setMessage","allOrders","setAllOrders","uploading","setUploading","errorImageUpload","setErrorImageUpload","dispatch","userDetails","state","loading","user","error","userLogin","userInfo","userProfileUpdate","success","orderListUser","loadingOrdersList","orders","errorOrdersList","userSendEmailVerfication","emailSent","hasError","isSocialLogin","JSON","parse","localStorage","getItem","length","push","type","id","showHidePassword","e","preventDefault","stopPropagation","showHideConfirmPassword","handleImageUpload","file","target","files","formData","FormData","append","config","headers","post","data","handleImageClick","current","click","handleSubmit","isConfirmed","margin","fontWeight","fontSize","focus","opacity","pointerEvents","display","flexFlow","alignSelf","height","width","marginBottom","border","borderRadius","cursor","value","borderRight","marginLeft","background","borderLeft","padding","map","order","idx","textAlign","createdAt","totalPrice","toLocaleString","maximumFractionDigits","style","currency","isPaid","paidAt","color","isDelivered","deliveredAt","_id"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport {\r\n  Form,\r\n  Button,\r\n  Row,\r\n  InputGroup,\r\n  Col,\r\n  Card,\r\n  Table,\r\n  Image,\r\n  FloatingLabel,\r\n} from \"react-bootstrap\";\r\nimport { LinkContainer } from \"react-router-bootstrap\";\r\nimport Loader from \"../components/Loader\";\r\nimport Message from \"../components/Message\";\r\nimport {\r\n  sendVerficationEmail,\r\n  getUserDetails,\r\n  updateUserProfile,\r\n  refreshLogin,\r\n} from \"../actions/userActions\";\r\nimport { listMyOrders } from \"../actions/orderActions\";\r\nimport { USER_PROFILE_UPDATE_RESET } from \"../constants/userConstants\";\r\nimport Meta from \"../components/Meta\";\r\nimport axios from \"axios\";\r\nimport getDateString from \"../utils/getDateString\";\r\nimport \"../styles/profile-page.css\";\r\n\r\nconst ProfilePage = ({ history }) => {\r\n  const inputFile = useRef(null);\r\n  const [showSubmitButton, setShowSubmitButton] = useState(false); // sisable the submit button unless some user detail is changed by user\r\n  const [typePassword, setTypePassword] = useState(\"password\");\r\n  const [typeConfirmPassword, setTypeConfirmPassword] = useState(\"password\");\r\n\r\n  const [name, setName] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [avatar, setAvatar] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n  const [message, setMessage] = useState(null);\r\n  const [allOrders, setAllOrders] = useState([]);\r\n\r\n  const [uploading, setUploading] = useState(false);\r\n  const [errorImageUpload, setErrorImageUpload] = useState(\"\");\r\n  const dispatch = useDispatch();\r\n\r\n  const userDetails = useSelector((state) => state.userDetails);\r\n  const { loading, user, error } = userDetails;\r\n\r\n  const userLogin = useSelector((state) => state.userLogin);\r\n  const { userInfo } = userLogin;\r\n\r\n  const userProfileUpdate = useSelector((state) => state.userProfileUpdate);\r\n  const { success } = userProfileUpdate;\r\n\r\n  const orderListUser = useSelector((state) => state.orderListUser);\r\n  const {\r\n    loading: loadingOrdersList,\r\n    orders,\r\n    error: errorOrdersList,\r\n  } = orderListUser;\r\n\r\n  // check whether verification email has to be sent\r\n  const userSendEmailVerfication = useSelector(\r\n    (state) => state.userSendEmailVerfication\r\n  );\r\n  const { emailSent, hasError } = userSendEmailVerfication;\r\n\r\n  // refresh access token for user details error\r\n  useEffect(() => {\r\n    if (error && userInfo && !userInfo.isSocialLogin) {\r\n      const user = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n      user && dispatch(refreshLogin(user.email));\r\n    }\r\n  }, [error, dispatch, userInfo]);\r\n\r\n  // set orders to local state\r\n  useEffect(() => {\r\n    if (orders && orders.length) {\r\n      setAllOrders([...orders]);\r\n    }\r\n  }, [orders]);\r\n\r\n  // check if any of the input fields value is changed, only then show the submit button\r\n  useEffect(() => {\r\n    if (userInfo) {\r\n      if (name && userInfo.name !== name) setShowSubmitButton(true);\r\n      else if (email && userInfo.email !== email) setShowSubmitButton(true);\r\n      else if (password || confirmPassword) setShowSubmitButton(true);\r\n      else setShowSubmitButton(false);\r\n    }\r\n  }, [name, email, password, confirmPassword, userInfo]);\r\n\r\n  useEffect(() => {\r\n    dispatch(listMyOrders());\r\n  }, [dispatch]);\r\n\r\n  useEffect(() => {\r\n    if (!userInfo) {\r\n      history.push(\"/login\");\r\n    } else {\r\n      // if user is null, first fetch it and then set its details to the local state\r\n      if (!user || !user.name || success) {\r\n        dispatch(listMyOrders());\r\n        dispatch({ type: USER_PROFILE_UPDATE_RESET });\r\n        userInfo\r\n          ? userInfo.isSocialLogin\r\n            ? dispatch(getUserDetails(userInfo.id))\r\n            : dispatch(getUserDetails(\"profile\"))\r\n          : dispatch(getUserDetails(\"profile\"));\r\n        if (success) {\r\n          userInfo.isSocialLogin\r\n            ? dispatch(getUserDetails(userInfo.id))\r\n            : dispatch(getUserDetails(\"profile\"));\r\n        }\r\n      } else {\r\n        setName(user.name);\r\n        setEmail(user.email);\r\n        setAvatar(user.avatar);\r\n      }\r\n    }\r\n  }, [history, userInfo, user, dispatch, success, loadingOrdersList]);\r\n\r\n  const showHidePassword = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setTypePassword(typePassword === \"password\" ? \"text\" : \"password\");\r\n  };\r\n\r\n  const showHideConfirmPassword = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setTypeConfirmPassword(\r\n      typeConfirmPassword === \"password\" ? \"text\" : \"password\"\r\n    );\r\n  };\r\n\r\n  // handle file upload to aws bucket\r\n  const handleImageUpload = async (e) => {\r\n    const file = e.target.files[0];\r\n    const formData = new FormData();\r\n    formData.append(\"image\", file);\r\n    setUploading(true);\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n      };\r\n\r\n      const { data } = await axios.post(\"/api/upload\", formData, config);\r\n      setAvatar(data);\r\n      dispatch(\r\n        updateUserProfile({\r\n          id: user.id,\r\n          avatar: data,\r\n        })\r\n      );\r\n      setUploading(false);\r\n    } catch (error) {\r\n      setErrorImageUpload(\"Please choose a valid image\");\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  // handle image overlay div's click to upload new file\r\n  const handleImageClick = () => {\r\n    inputFile.current.click();\r\n  };\r\n\r\n  // update user details\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    if (password !== confirmPassword) {\r\n      setMessage(\"Passwords do not match. Please retry.\");\r\n    } else {\r\n      dispatch(\r\n        updateUserProfile({\r\n          id: user.id,\r\n          name,\r\n          email,\r\n          avatar,\r\n          password,\r\n          confirmPassword,\r\n        })\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Row className=\"mt-2\">\r\n      <Meta title=\"My Profile | The Style Studio\" />\r\n      {userInfo && !userInfo.isConfirmed ? (\r\n        <>\r\n          {emailSent && (\r\n            <Message variant=\"success\" dismissible>\r\n              A verification link has been sent your mail!\r\n            </Message>\r\n          )}\r\n          {hasError && (\r\n            <Message dismissible variant=\"danger\">\r\n              {hasError}\r\n            </Message>\r\n          )}\r\n          <Card style={{ margin: \"0\" }} className=\"mb-3\">\r\n            <Card.Body className=\"ps-0 \">\r\n              <Card.Title style={{ fontWeight: \"bold\" }}>\r\n                Account Not Verified\r\n              </Card.Title>\r\n              <Card.Text>\r\n                {`${userInfo.name}, `} your account is not yet verfied. Please{\" \"}\r\n                <Button\r\n                  variant=\"link\"\r\n                  className=\"p-0\"\r\n                  style={{\r\n                    fontSize: \"0.9em\",\r\n                    margin: \"0 0 0.1em 0\",\r\n                    focus: \"none\",\r\n                  }}\r\n                  onClick={() => dispatch(sendVerficationEmail(userInfo.email))}\r\n                >\r\n                  click here\r\n                </Button>{\" \"}\r\n                to send a verfication email.\r\n              </Card.Text>\r\n            </Card.Body>\r\n          </Card>\r\n        </>\r\n      ) : null}\r\n      <Col\r\n        md={3}\r\n        style={\r\n          userInfo && !userInfo.isConfirmed\r\n            ? {\r\n                opacity: \"0.5\",\r\n                pointerEvents: \"none\",\r\n              }\r\n            : {\r\n                opacity: \"1\",\r\n                pointerEvents: \"\",\r\n              }\r\n        }\r\n      >\r\n        <h2 className=\"text-center\">My Profile</h2>\r\n        {message && (\r\n          <Message dismissible variant=\"warning\" duration={8}>\r\n            {message}\r\n          </Message>\r\n        )}\r\n        {error && error !== \"Not authorised. Token failed\" && (\r\n          <Message dismissible variant=\"danger\" duration={10}>\r\n            {error}\r\n          </Message>\r\n        )}\r\n        {success && (\r\n          <Message dismissible variant=\"success\" duration={8}>\r\n            Profile Updated!\r\n          </Message>\r\n        )}\r\n        {loading ? (\r\n          <Loader />\r\n        ) : (\r\n          <div style={{ display: \"flex\", flexFlow: \"column nowrap\" }}>\r\n            {errorImageUpload && (\r\n              <Message dismissible variant=\"danger\" duration={10}>\r\n                {errorImageUpload}\r\n              </Message>\r\n            )}\r\n            {uploading ? (\r\n              <Loader />\r\n            ) : (\r\n              <div\r\n                className=\"profile-page-image\"\r\n                style={{ alignSelf: \"center\" }}\r\n              >\r\n                <Image\r\n                  src={avatar}\r\n                  alt={name}\r\n                  style={{\r\n                    height: \"5em\",\r\n                    width: \"5em\",\r\n                    marginBottom: \"1em\",\r\n                    border: \"1px solid #ced4da\",\r\n                    borderRadius: \"50%\",\r\n                    cursor: \"pointer\",\r\n                  }}\r\n                />\r\n                <div className=\"image-overlay\" onClick={handleImageClick}>\r\n                  Click to upload image\r\n                </div>\r\n              </div>\r\n            )}\r\n            {/* for image upload */}\r\n            <input\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              id=\"file\"\r\n              ref={inputFile}\r\n              onChange={handleImageUpload}\r\n              style={{ display: \"none\" }}\r\n            />\r\n            <Form onSubmit={handleSubmit}>\r\n              <Form.Group controlId=\"name\">\r\n                <FloatingLabel\r\n                  controlId=\"nameinput\"\r\n                  label=\"Name\"\r\n                  className=\"mb-3\"\r\n                >\r\n                  <Form.Control\r\n                    size=\"lg\"\r\n                    placeholder=\"Enter Name\"\r\n                    type=\"text\"\r\n                    value={name}\r\n                    onChange={(e) => setName(e.target.value)}\r\n                  />\r\n                </FloatingLabel>\r\n              </Form.Group>\r\n              <Form.Group\r\n                controlId=\"email\"\r\n                className=\"my-2\"\r\n                style={\r\n                  userInfo && userInfo.isSocialLogin\r\n                    ? {\r\n                        pointerEvents: \"none\",\r\n                        opacity: \"0.8\",\r\n                      }\r\n                    : {}\r\n                }\r\n              >\r\n                <FloatingLabel\r\n                  controlId=\"emailinput\"\r\n                  label=\"Email\"\r\n                  className=\"mb-3\"\r\n                >\r\n                  <Form.Control\r\n                    size=\"lg\"\r\n                    placeholder=\"Enter Email Address\"\r\n                    type=\"email\"\r\n                    value={email}\r\n                    onChange={(e) => setEmail(e.target.value)}\r\n                  />\r\n                </FloatingLabel>\r\n              </Form.Group>\r\n              {userInfo && !userInfo.isSocialLogin && (\r\n                <>\r\n                  <Form.Group>\r\n                    <InputGroup className=\"d-block\">\r\n                      <FloatingLabel\r\n                        controlId=\"passwordinput\"\r\n                        label=\"Password\"\r\n                        style={{ display: \"flex\" }}\r\n                        className=\"mb-3\"\r\n                      >\r\n                        <Form.Control\r\n                          size=\"lg\"\r\n                          type={typePassword}\r\n                          placeholder=\"Enter your password\"\r\n                          value={password}\r\n                          style={{\r\n                            borderRight: \"none\",\r\n                            width: \"100%\",\r\n                          }}\r\n                          onChange={(e) => setPassword(e.target.value)}\r\n                        />\r\n                        <div className=\"input-group-append\">\r\n                          <InputGroup.Text\r\n                            onClick={showHidePassword}\r\n                            style={{\r\n                              fontSize: \"1rem\",\r\n                              height: \"100%\",\r\n                              marginLeft: \"-0.5em\",\r\n                              background: \"transparent\",\r\n                              borderLeft: \"none\",\r\n                            }}\r\n                          >\r\n                            {typePassword === \"text\" ? (\r\n                              <i className=\"far fa-eye-slash\" />\r\n                            ) : (\r\n                              <i className=\"far fa-eye\" />\r\n                            )}\r\n                          </InputGroup.Text>\r\n                        </div>\r\n                      </FloatingLabel>\r\n                    </InputGroup>\r\n                  </Form.Group>\r\n                  <Form.Group>\r\n                    <InputGroup className=\"d-block\">\r\n                      <FloatingLabel\r\n                        controlId=\"confirmpasswordinput\"\r\n                        label=\"Confirm Password\"\r\n                        style={{ display: \"flex\" }}\r\n                        className=\"mb-3\"\r\n                      >\r\n                        <Form.Control\r\n                          size=\"lg\"\r\n                          type={typeConfirmPassword}\r\n                          placeholder=\"Confirm password\"\r\n                          value={confirmPassword}\r\n                          style={{\r\n                            borderRight: \"none\",\r\n                          }}\r\n                          onChange={(e) => setConfirmPassword(e.target.value)}\r\n                        />\r\n                        <div className=\"input-group-append\">\r\n                          <InputGroup.Text\r\n                            onClick={showHideConfirmPassword}\r\n                            style={{\r\n                              fontSize: \"1rem\",\r\n                              height: \"100%\",\r\n                              marginLeft: \"-0.5em\",\r\n                              background: \"transparent\",\r\n                              borderLeft: \"none\",\r\n                            }}\r\n                          >\r\n                            {typeConfirmPassword === \"text\" ? (\r\n                              <i className=\"far fa-eye-slash\" />\r\n                            ) : (\r\n                              <i className=\"far fa-eye\" />\r\n                            )}\r\n                          </InputGroup.Text>\r\n                        </div>\r\n                      </FloatingLabel>\r\n                    </InputGroup>\r\n                  </Form.Group>\r\n                </>\r\n              )}\r\n              <div className=\"d-grid mb-3\">\r\n                <Button\r\n                  type=\"submit\"\r\n                  disabled={!showSubmitButton}\r\n                  style={{\r\n                    padding: \"0.5em 1em\",\r\n                  }}\r\n                >\r\n                  Update Profile\r\n                </Button>\r\n              </div>\r\n            </Form>\r\n          </div>\r\n        )}\r\n      </Col>\r\n      {/* display orders */}\r\n      <Col\r\n        md={9}\r\n        style={\r\n          userInfo && !userInfo.isConfirmed\r\n            ? {\r\n                opacity: \"0.5\",\r\n                pointerEvents: \"none\",\r\n              }\r\n            : {\r\n                opacity: \"1\",\r\n                pointerEvents: \"\",\r\n              }\r\n        }\r\n      >\r\n        {allOrders.length ? (\r\n          <>\r\n            <h2 className=\"text-center\">My Orders</h2>\r\n            {loadingOrdersList ? (\r\n              <Loader />\r\n            ) : errorOrdersList ? (\r\n              <Message dismissible variant=\"danger\" duration={10}>\r\n                {errorOrdersList}\r\n              </Message>\r\n            ) : (\r\n              <Table\r\n                striped\r\n                bordered\r\n                responsive\r\n                className=\"table-sm text-center\"\r\n              >\r\n                <thead>\r\n                  <tr>\r\n                    <th>DATE</th>\r\n                    <th>TOTAL</th>\r\n                    <th>PAID</th>\r\n                    <th>DELIVERED</th>\r\n                    <th>ACTION</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {orders.map((order, idx) => (\r\n                    <tr\r\n                      key={idx}\r\n                      style={{\r\n                        textAlign: \"center\",\r\n                        padding: \"0\",\r\n                      }}\r\n                    >\r\n                      <td>{getDateString(order.createdAt)}</td>\r\n                      <td>\r\n                        {order.totalPrice.toLocaleString(\"en-US\", {\r\n                          maximumFractionDigits: 0,\r\n                          style: \"currency\",\r\n                          currency: \"USD\",\r\n                        })}\r\n                      </td>\r\n                      <td>\r\n                        {order.isPaid ? (\r\n                          getDateString(order.paidAt)\r\n                        ) : (\r\n                          <i\r\n                            className=\"fas fa-times\"\r\n                            style={{\r\n                              color: \"red\",\r\n                            }}\r\n                          />\r\n                        )}\r\n                      </td>\r\n                      <td>\r\n                        {order.isDelivered ? (\r\n                          getDateString(order.deliveredAt)\r\n                        ) : (\r\n                          <i\r\n                            className=\"fas fa-times\"\r\n                            style={{\r\n                              color: \"red\",\r\n                            }}\r\n                          />\r\n                        )}\r\n                      </td>\r\n                      <td>\r\n                        <LinkContainer to={`/order/${order._id}`}>\r\n                          <Button\r\n                            variant=\"link\"\r\n                            className=\"btn-sm\"\r\n                            style={{ margin: \"0\" }}\r\n                          >\r\n                            Details\r\n                          </Button>\r\n                        </LinkContainer>\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </Table>\r\n            )}\r\n          </>\r\n        ) : (\r\n          <Card style={{ border: \"none\", margin: \"0 auto\" }}>\r\n            <Card.Body>\r\n              <Card.Title>No Orders Yet!</Card.Title>\r\n              <Card.Text>\r\n                Details about all your orders will show up here.{\" \"}\r\n                <Link to=\"/\">Continue Shopping</Link>\r\n              </Card.Text>\r\n            </Card.Body>\r\n          </Card>\r\n        )}\r\n      </Col>\r\n    </Row>\r\n  );\r\n};\r\n\r\nexport default ProfilePage;\r\n"]},"metadata":{},"sourceType":"module"}