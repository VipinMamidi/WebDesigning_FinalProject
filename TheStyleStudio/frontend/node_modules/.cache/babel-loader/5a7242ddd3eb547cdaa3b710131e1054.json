{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Urvi\\\\Documents\\\\INFO6150\\\\MERN-Ecommerce\\\\MERN-Ecommerce\\\\frontend\\\\src\\\\pages\\\\PlaceOrderPage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Button, Row, Col, ListGroup, Image, Card } from \"react-bootstrap\";\nimport { Link } from \"react-router-dom\";\nimport CheckoutStatus from \"../components/CheckoutStatus\";\nimport Message from \"../components/Message\";\nimport Loader from \"../components/Loader\";\nimport { createOrder } from \"../actions/orderActions\";\nimport { CART_RESET } from \"../constants/cartConstants\";\nimport { refreshLogin, getUserDetails } from \"../actions/userActions\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst PlaceOrderPage = ({\n  history\n}) => {\n  _s();\n\n  const dispatch = useDispatch();\n  const cart = useSelector(state => state.cart);\n  const {\n    cartItems,\n    shippingAddress,\n    paymentMethod\n  } = cart;\n  const orderCreate = useSelector(state => state.orderCreate);\n  const {\n    order,\n    loading,\n    success,\n    error\n  } = orderCreate;\n  const userLogin = useSelector(state => state.userLogin);\n  const {\n    userInfo\n  } = userLogin;\n  const userDetails = useSelector(state => state.userDetails);\n  const {\n    error: userLoginError\n  } = userDetails; // fetch the userinfo from reducx store\n\n  useEffect(() => {\n    userInfo ? userInfo.isSocialLogin ? dispatch(getUserDetails(userInfo.id)) : dispatch(getUserDetails(\"profile\")) : dispatch(getUserDetails(\"profile\"));\n  }, [userInfo, dispatch]); // refresh access token when user detail throws error\n\n  useEffect(() => {\n    if (userLoginError && userInfo && !userInfo.isSocialLogin) {\n      const user = JSON.parse(localStorage.getItem(\"userInfo\"));\n      user && dispatch(refreshLogin(user.email));\n    }\n  }, [userLoginError, dispatch, userInfo]);\n  useEffect(() => {\n    if (success) {\n      localStorage.removeItem(\"cartItems\");\n      dispatch({\n        type: CART_RESET,\n        payload: shippingAddress\n      }); // remove items from cart once paid, but keep the shipping address in store\n\n      history.push(`/order/${order._id}`);\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [success, history]); // All prices, tax is randomly  assigned\n\n  cart.itemsPrice = cartItems.reduce((acc, item) => acc + item.price * item.qty, 0);\n  cart.shippingPrice = cart.itemsPrice > 8000 ? 500 : 300;\n  cart.taxPrice = 0.18 * cart.itemsPrice;\n  cart.totalPrice = cart.itemsPrice + cart.taxPrice + cart.shippingPrice;\n\n  const handleOrder = e => {\n    e.preventDefault();\n    dispatch(createOrder({\n      orderItems: cartItems,\n      shippingAddress,\n      paymentMethod,\n      itemsPrice: cart.itemsPrice,\n      shippingPrice: cart.shippingPrice,\n      taxPrice: cart.taxPrice,\n      totalPrice: cart.totalPrice\n    }));\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(CheckoutStatus, {\n      step1: true,\n      step2: true,\n      step3: true,\n      step4: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: loading ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          md: 8,\n          children: /*#__PURE__*/_jsxDEV(ListGroup, {\n            variant: \"flush\",\n            children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"Shipping\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 90,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Address: \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 92,\n                  columnNumber: 21\n                }, this), \" \", shippingAddress.address, \",\", \" \", shippingAddress.city, \"-\", shippingAddress.postalCode, \",\", \" \", shippingAddress.country]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 91,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"Payment Method\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 98,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Method: \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 100,\n                  columnNumber: 21\n                }, this), \" \", paymentMethod]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 99,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"Cart Items\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 104,\n                columnNumber: 19\n              }, this), cartItems.length !== 0 ? /*#__PURE__*/_jsxDEV(ListGroup, {\n                variant: \"flush\",\n                children: cartItems.map((item, idx) => /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                  children: /*#__PURE__*/_jsxDEV(Row, {\n                    children: [/*#__PURE__*/_jsxDEV(Col, {\n                      md: 2,\n                      children: /*#__PURE__*/_jsxDEV(Image, {\n                        className: \"product-image\",\n                        src: item.image,\n                        alt: item.name,\n                        fluid: true,\n                        rounded: true\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 111,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 110,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(Col, {\n                      children: /*#__PURE__*/_jsxDEV(Link, {\n                        to: `/product/${item.product}`,\n                        children: item.name\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 120,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 119,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(Col, {\n                      md: 4,\n                      children: [item.qty, \" x \", item.price, \" =\", \" \", (item.qty * item.price).toLocaleString(\"en-US\", {\n                        maximumFractionDigits: 2,\n                        style: \"currency\",\n                        currency: \"USD\"\n                      })]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 124,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 109,\n                    columnNumber: 27\n                  }, this)\n                }, idx, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 108,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 106,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(Message, {\n                children: \"Your cart is empty\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 137,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 4,\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            children: /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                className: \"text-center\",\n                children: /*#__PURE__*/_jsxDEV(\"h2\", {\n                  className: \"text-center\",\n                  children: \"Order Summary\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 146,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Subtotal\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 151,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 150,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: Number(cart.itemsPrice).toLocaleString(\"en-US\", {\n                      maximumFractionDigits: 2,\n                      style: \"currency\",\n                      currency: \"USD\"\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 153,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 149,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Shipping\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 165,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 164,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: Number(cart.shippingPrice).toLocaleString(\"en-US\", {\n                      maximumFractionDigits: 2,\n                      style: \"currency\",\n                      currency: \"USD\"\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 167,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 163,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Tax\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 179,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 178,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: Number(cart.taxPrice).toLocaleString(\"en-US\", {\n                      maximumFractionDigits: 2,\n                      style: \"currency\",\n                      currency: \"USD\"\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 181,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 177,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 176,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Total\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 193,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 192,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: Number(cart.totalPrice).toLocaleString(\"en-US\", {\n                      maximumFractionDigits: 2,\n                      style: \"currency\",\n                      currency: \"USD\"\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 195,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 191,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 190,\n                columnNumber: 19\n              }, this), error && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Message, {\n                  dismissible: true,\n                  variant: \"danger\",\n                  duration: 10,\n                  children: error\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 206,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 205,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                className: \"d-grid gap-2\",\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  type: \"button\",\n                  size: \"lg\",\n                  disabled: !cartItems.length,\n                  onClick: handleOrder,\n                  children: \"Place Order\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(PlaceOrderPage, \"ZVtwlPcLyyX06ctdnX/P2Bl+sdQ=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = PlaceOrderPage;\nexport default PlaceOrderPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"PlaceOrderPage\");","map":{"version":3,"sources":["C:/Users/Urvi/Documents/INFO6150/MERN-Ecommerce/MERN-Ecommerce/frontend/src/pages/PlaceOrderPage.js"],"names":["React","useEffect","useDispatch","useSelector","Button","Row","Col","ListGroup","Image","Card","Link","CheckoutStatus","Message","Loader","createOrder","CART_RESET","refreshLogin","getUserDetails","PlaceOrderPage","history","dispatch","cart","state","cartItems","shippingAddress","paymentMethod","orderCreate","order","loading","success","error","userLogin","userInfo","userDetails","userLoginError","isSocialLogin","id","user","JSON","parse","localStorage","getItem","email","removeItem","type","payload","push","_id","itemsPrice","reduce","acc","item","price","qty","shippingPrice","taxPrice","totalPrice","handleOrder","e","preventDefault","orderItems","address","city","postalCode","country","length","map","idx","image","name","product","toLocaleString","maximumFractionDigits","style","currency","Number"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Button, Row, Col, ListGroup, Image, Card } from \"react-bootstrap\";\r\nimport { Link } from \"react-router-dom\";\r\nimport CheckoutStatus from \"../components/CheckoutStatus\";\r\nimport Message from \"../components/Message\";\r\nimport Loader from \"../components/Loader\";\r\nimport { createOrder } from \"../actions/orderActions\";\r\nimport { CART_RESET } from \"../constants/cartConstants\";\r\nimport { refreshLogin, getUserDetails } from \"../actions/userActions\";\r\n\r\nconst PlaceOrderPage = ({ history }) => {\r\n  const dispatch = useDispatch();\r\n\r\n  const cart = useSelector((state) => state.cart);\r\n  const { cartItems, shippingAddress, paymentMethod } = cart;\r\n\r\n  const orderCreate = useSelector((state) => state.orderCreate);\r\n  const { order, loading, success, error } = orderCreate;\r\n\r\n  const userLogin = useSelector((state) => state.userLogin);\r\n  const { userInfo } = userLogin;\r\n\r\n  const userDetails = useSelector((state) => state.userDetails);\r\n  const { error: userLoginError } = userDetails;\r\n\r\n  // fetch the userinfo from reducx store\r\n  useEffect(() => {\r\n    userInfo\r\n      ? userInfo.isSocialLogin\r\n        ? dispatch(getUserDetails(userInfo.id))\r\n        : dispatch(getUserDetails(\"profile\"))\r\n      : dispatch(getUserDetails(\"profile\"));\r\n  }, [userInfo, dispatch]);\r\n\r\n  // refresh access token when user detail throws error\r\n  useEffect(() => {\r\n    if (userLoginError && userInfo && !userInfo.isSocialLogin) {\r\n      const user = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n      user && dispatch(refreshLogin(user.email));\r\n    }\r\n  }, [userLoginError, dispatch, userInfo]);\r\n\r\n  useEffect(() => {\r\n    if (success) {\r\n      localStorage.removeItem(\"cartItems\");\r\n      dispatch({ type: CART_RESET, payload: shippingAddress }); // remove items from cart once paid, but keep the shipping address in store\r\n      history.push(`/order/${order._id}`);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [success, history]);\r\n\r\n  // All prices, tax is randomly  assigned\r\n  cart.itemsPrice = cartItems.reduce(\r\n    (acc, item) => acc + item.price * item.qty,\r\n    0\r\n  );\r\n\r\n  cart.shippingPrice = cart.itemsPrice > 8000 ? 500 : 300;\r\n  cart.taxPrice = 0.18 * cart.itemsPrice;\r\n  cart.totalPrice = cart.itemsPrice + cart.taxPrice + cart.shippingPrice;\r\n\r\n  const handleOrder = (e) => {\r\n    e.preventDefault();\r\n    dispatch(\r\n      createOrder({\r\n        orderItems: cartItems,\r\n        shippingAddress,\r\n        paymentMethod,\r\n        itemsPrice: cart.itemsPrice,\r\n        shippingPrice: cart.shippingPrice,\r\n        taxPrice: cart.taxPrice,\r\n        totalPrice: cart.totalPrice,\r\n      })\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* last step in the ckecout process */}\r\n      <CheckoutStatus step1 step2 step3 step4 />\r\n      <Row>\r\n        {loading ? (\r\n          <Loader />\r\n        ) : (\r\n          <>\r\n            <Col md={8}>\r\n              <ListGroup variant=\"flush\">\r\n                <ListGroup.Item>\r\n                  <h2>Shipping</h2>\r\n                  <p>\r\n                    <strong>Address: </strong> {shippingAddress.address},{\" \"}\r\n                    {shippingAddress.city}-{shippingAddress.postalCode},{\" \"}\r\n                    {shippingAddress.country}\r\n                  </p>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <h2>Payment Method</h2>\r\n                  <p>\r\n                    <strong>Method: </strong> {paymentMethod}\r\n                  </p>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <h2>Cart Items</h2>\r\n                  {cartItems.length !== 0 ? (\r\n                    <ListGroup variant=\"flush\">\r\n                      {cartItems.map((item, idx) => (\r\n                        <ListGroup.Item key={idx}>\r\n                          <Row>\r\n                            <Col md={2}>\r\n                              <Image\r\n                                className=\"product-image\"\r\n                                src={item.image}\r\n                                alt={item.name}\r\n                                fluid\r\n                                rounded\r\n                              />\r\n                            </Col>\r\n                            <Col>\r\n                              <Link to={`/product/${item.product}`}>\r\n                                {item.name}\r\n                              </Link>\r\n                            </Col>\r\n                            <Col md={4}>\r\n                              {item.qty} x {item.price} ={\" \"}\r\n                              {(item.qty * item.price).toLocaleString(\"en-US\", {\r\n                                maximumFractionDigits: 2,\r\n                                style: \"currency\",\r\n                                currency: \"USD\",\r\n                              })}\r\n                            </Col>\r\n                          </Row>\r\n                        </ListGroup.Item>\r\n                      ))}\r\n                    </ListGroup>\r\n                  ) : (\r\n                    <Message>Your cart is empty</Message>\r\n                  )}\r\n                </ListGroup.Item>\r\n              </ListGroup>\r\n            </Col>\r\n            <Col md={4}>\r\n              <Card>\r\n                <ListGroup variant=\"flush\">\r\n                  <ListGroup.Item className=\"text-center\">\r\n                    <h2 className=\"text-center\">Order Summary</h2>\r\n                  </ListGroup.Item>\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>\r\n                        <strong>Subtotal</strong>\r\n                      </Col>\r\n                      <Col>\r\n                        {Number(cart.itemsPrice).toLocaleString(\"en-US\", {\r\n                          maximumFractionDigits: 2,\r\n                          style: \"currency\",\r\n                          currency: \"USD\",\r\n                        })}\r\n                      </Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>\r\n                        <strong>Shipping</strong>\r\n                      </Col>\r\n                      <Col>\r\n                        {Number(cart.shippingPrice).toLocaleString(\"en-US\", {\r\n                          maximumFractionDigits: 2,\r\n                          style: \"currency\",\r\n                          currency: \"USD\",\r\n                        })}\r\n                      </Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>\r\n                        <strong>Tax</strong>\r\n                      </Col>\r\n                      <Col>\r\n                        {Number(cart.taxPrice).toLocaleString(\"en-US\", {\r\n                          maximumFractionDigits: 2,\r\n                          style: \"currency\",\r\n                          currency: \"USD\",\r\n                        })}\r\n                      </Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>\r\n                        <strong>Total</strong>\r\n                      </Col>\r\n                      <Col>\r\n                        {Number(cart.totalPrice).toLocaleString(\"en-US\", {\r\n                          maximumFractionDigits: 2,\r\n                          style: \"currency\",\r\n                          currency: \"USD\",\r\n                        })}\r\n                      </Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                  {error && (\r\n                    <ListGroup.Item>\r\n                      <Message dismissible variant=\"danger\" duration={10}>\r\n                        {error}\r\n                      </Message>\r\n                    </ListGroup.Item>\r\n                  )}\r\n                  <ListGroup.Item className=\"d-grid gap-2\">\r\n                    <Button\r\n                      type=\"button\"\r\n                      size=\"lg\"\r\n                      disabled={!cartItems.length}\r\n                      onClick={handleOrder}\r\n                    >\r\n                      Place Order\r\n                    </Button>\r\n                  </ListGroup.Item>\r\n                </ListGroup>\r\n              </Card>\r\n            </Col>\r\n          </>\r\n        )}\r\n      </Row>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PlaceOrderPage;\r\n"]},"metadata":{},"sourceType":"module"}