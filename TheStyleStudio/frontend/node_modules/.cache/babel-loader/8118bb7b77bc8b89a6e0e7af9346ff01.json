{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Urvi\\\\Documents\\\\INFO6150\\\\MERN-Ecommerce\\\\MERN-Ecommerce\\\\frontend\\\\src\\\\pages\\\\ProductPage.js\",\n    _s = $RefreshSig$();\n\n/* eslint-disable array-callback-return */\nimport React, { useState, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { Row, Col, Card, Button, ListGroup, Form, FloatingLabel } from \"react-bootstrap\";\nimport ImageMagnifier from \"../components/ImageMagnifier\"; // to magnify image on hover\n\nimport Rating from \"../components/Rating\";\nimport Meta from \"../components/Meta\";\nimport Loader from \"../components/Loader\";\nimport Message from \"../components/Message\";\nimport { listProductDetails, createProductReview } from \"../actions/productActions\";\nimport { listMyOrders } from \"../actions/orderActions\";\nimport { refreshLogin, getUserDetails } from \"../actions/userActions\";\nimport { PRODUCT_CREATE_REVIEW_RESET } from \"../constants/productConstants\";\nimport getDateString from \"../utils/getDateString\";\nimport \"../styles/product-page.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst ProductPage = ({\n  history,\n  match\n}) => {\n  _s();\n\n  const [quantity, setQuantity] = useState(1);\n  const [rating, setRating] = useState(0);\n  const [review, setReview] = useState(\"\");\n  const [allReviews, setAllReviews] = useState([]);\n  const [hasOrderedItem, setHasOrderedItem] = useState(false); // bool to check if the user has ordered this product\n\n  const [showReviewForm, setShowReviewForm] = useState(false); // bool to decide whether to show the review form or not\n\n  const dispatch = useDispatch();\n  const userLogin = useSelector(state => state.userLogin);\n  const {\n    userInfo\n  } = userLogin;\n  const productDetails = useSelector(state => state.productDetails);\n  const {\n    loading,\n    product,\n    error\n  } = productDetails;\n  const userDetails = useSelector(state => state.userDetails);\n  const {\n    error: userLoginError\n  } = userDetails;\n  const productCreateReview = useSelector(state => state.productCreateReview);\n  const {\n    loading: loadingCreateReview,\n    success: successCreateReview,\n    error: errorCreateReview\n  } = productCreateReview;\n  const orderListUser = useSelector(state => state.orderListUser);\n  const {\n    orders\n  } = orderListUser; // fetch user login info\n\n  useEffect(() => {\n    userInfo ? userInfo.isSocialLogin ? dispatch(getUserDetails(userInfo.id)) : dispatch(getUserDetails(\"profile\")) : dispatch(getUserDetails(\"profile\"));\n  }, [userInfo, dispatch]); // refresh the access tokens for accessing user details\n\n  useEffect(() => {\n    if (userLoginError && userInfo && !userInfo.isSocialLogin) {\n      const user = JSON.parse(localStorage.getItem(\"userInfo\"));\n      user && dispatch(refreshLogin(user.email));\n    }\n  }, [userLoginError, dispatch, userInfo]);\n  useEffect(() => {\n    dispatch(listMyOrders());\n  }, [dispatch]); // add a new review, and reset the stored product review in the redux store\n\n  useEffect(() => {\n    if (successCreateReview) {\n      window.alert(\"Review Submitted!!\");\n      setRating(0);\n      setReview(\"\");\n      dispatch({\n        type: PRODUCT_CREATE_REVIEW_RESET\n      });\n    }\n\n    dispatch(listProductDetails(match.params.id));\n  }, [match, dispatch, successCreateReview]);\n  useEffect(() => {\n    if (product && product.reviews && userInfo) {\n      let flag = 0; // to check if this user has already reviewed this product\n\n      for (let review of product.reviews) {\n        if (review.user === userInfo.id) {\n          flag = 1;\n          break;\n        }\n      }\n\n      flag ? setShowReviewForm(false) : setShowReviewForm(true);\n    } else {\n      setShowReviewForm(true);\n    }\n  }, [product, userInfo]);\n  useEffect(() => {\n    if (orders && orders.length) {\n      let flag = 0; // to check is this user has ordered this item\n\n      for (let obj of orders) {\n        for (let ele of obj.orderItems) {\n          if (ele.product.toString() === match.params.id) {\n            flag = 1;\n            break;\n          }\n        }\n      }\n\n      flag ? setHasOrderedItem(true) : setHasOrderedItem(false);\n    } else {\n      setHasOrderedItem(false);\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [orders]); // arrange all reviews in reverse chronological order\n\n  useEffect(() => {\n    if (product && product.reviews) {\n      const sortedArr = product.reviews.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));\n      setAllReviews(sortedArr);\n    }\n  }, [product]);\n\n  const handleAddToCart = e => {\n    history.push(`/cart/${match.params.id}?qty=${quantity}`);\n  };\n\n  const handleReviewSubmit = e => {\n    dispatch(createProductReview(match.params.id, {\n      rating,\n      review\n    }));\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Link, {\n      className: \"btn btn-outline-primary my-2\",\n      to: \"/\",\n      children: \"Go Back\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }, this), product && (!product._id || product._id !== match.params.id) ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 9\n    }, this) : error ? /*#__PURE__*/_jsxDEV(Message, {\n      dismissible: true,\n      variant: \"danger\",\n      duration: 10,\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 9\n    }, this) : product ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Meta, {\n        title: `${product.name}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          md: 6,\n          children: /*#__PURE__*/_jsxDEV(ImageMagnifier, {\n            src: product.image,\n            alt: product.name,\n            title: product.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 3,\n          children: /*#__PURE__*/_jsxDEV(ListGroup, {\n            variant: \"flush\",\n            children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: /*#__PURE__*/_jsxDEV(\"h3\", {\n                children: product.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: product && product.rating && /*#__PURE__*/_jsxDEV(Rating, {\n                value: product.rating,\n                text: `${product.numReviews} Review${product.numReviews > 1 ? \"s\" : \"\"}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Price: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 19\n              }, this), product.price && product.price.toLocaleString(\"en-IN\", {\n                maximumFractionDigits: 2,\n                style: \"currency\",\n                currency: \"USD\"\n              })]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Description:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 19\n              }, this), \" \", product.description]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 3,\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            children: [/*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Price: \"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 202,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 201,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: product.price && product.price.toLocaleString(\"en-IN\", {\n                      maximumFractionDigits: 2,\n                      style: \"currency\",\n                      currency: \"USD\"\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 204,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 200,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n              variant: \"flush\",\n              children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Status: \"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 219,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 218,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: product.countInStock > 0 ? \"In Stock\" : \"Out of Stock\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 221,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 217,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 19\n              }, this), product.countInStock > 0 && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"Qty:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 230,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 229,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    children: /*#__PURE__*/_jsxDEV(Form.Control, {\n                      as: \"select\",\n                      value: quantity,\n                      onChange: e => setQuantity(e.target.value),\n                      children: [...Array(product.countInStock).keys()].map(ele => /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: ele + 1,\n                        children: ele + 1\n                      }, ele + 1, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 241,\n                        columnNumber: 33\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 233,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 232,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 228,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 227,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: /*#__PURE__*/_jsxDEV(Row, {\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    onClick: handleAddToCart,\n                    type: \"button\",\n                    className: \"btn-block btn-lg\",\n                    disabled: product.countInStock <= 0,\n                    children: \"Add To Cart\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 253,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 252,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          md: 6,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"mt-3\",\n            children: \"Reviews\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 15\n          }, this), (!product.reviews || !product.reviews.length) && /*#__PURE__*/_jsxDEV(Message, {\n            variant: \"secondary\",\n            children: \"No Reviews Yet\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n            variant: \"flush\",\n            children: [allReviews.map(item => {\n              return /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                    src: item.avatar,\n                    alt: item.name,\n                    className: \"review-avatar\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 281,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: item.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 286,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 280,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(Rating, {\n                  value: item.rating\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 288,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    margin: \"0\",\n                    fontSize: \"1.1em\"\n                  },\n                  children: item.review\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 289,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                  style: {\n                    fontSize: \"0.9em\"\n                  },\n                  children: getDateString(item.createdAt, false)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 23\n                }, this)]\n              }, item._id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 279,\n                columnNumber: 21\n              }, this);\n            }), hasOrderedItem && !showReviewForm && /*#__PURE__*/_jsxDEV(Message, {\n              dismissible: true,\n              children: \"You have already reviewed this product\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 19\n            }, this), hasOrderedItem && showReviewForm && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"Write a Customer Review\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 314,\n                columnNumber: 21\n              }, this), errorCreateReview && /*#__PURE__*/_jsxDEV(Message, {\n                dismissible: true,\n                variant: \"info\",\n                duration: 10,\n                children: errorCreateReview\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 316,\n                columnNumber: 23\n              }, this), loadingCreateReview && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(Form, {\n                onSubmit: handleReviewSubmit,\n                children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n                  controlId: \"rating\",\n                  children: /*#__PURE__*/_jsxDEV(Form.Control, {\n                    as: \"select\",\n                    value: rating,\n                    onChange: e => setRating(e.target.value),\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      default: true,\n                      children: \"Choose Rating\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 328,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"1\",\n                      children: \"1 - Bad\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 329,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"2\",\n                      children: \"2 - Poor\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 330,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"3\",\n                      children: \"3 - Fair\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 331,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"4\",\n                      children: \"4 - Good\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 332,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"5\",\n                      children: \"5 - Excellent\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 333,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 323,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 322,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n                  controlId: \"comment\",\n                  children: /*#__PURE__*/_jsxDEV(FloatingLabel, {\n                    controlId: \"commenttext\",\n                    label: \"Comment\",\n                    className: \"my-3\",\n                    children: /*#__PURE__*/_jsxDEV(Form.Control, {\n                      as: \"textarea\",\n                      placeholder: \"Leave a comment here\",\n                      row: \"3\",\n                      onChange: e => setReview(e.target.value),\n                      value: review\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 342,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 337,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 336,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-grid\",\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    type: \"submit\",\n                    children: \"Submit Review\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 352,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 351,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 321,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true) : \"\"]\n  }, void 0, true);\n};\n\n_s(ProductPage, \"c7QxbZVFCGRlnrXH7lCQQ2T0944=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = ProductPage;\nexport default ProductPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductPage\");","map":{"version":3,"sources":["C:/Users/Urvi/Documents/INFO6150/MERN-Ecommerce/MERN-Ecommerce/frontend/src/pages/ProductPage.js"],"names":["React","useState","useEffect","useDispatch","useSelector","Link","Row","Col","Card","Button","ListGroup","Form","FloatingLabel","ImageMagnifier","Rating","Meta","Loader","Message","listProductDetails","createProductReview","listMyOrders","refreshLogin","getUserDetails","PRODUCT_CREATE_REVIEW_RESET","getDateString","ProductPage","history","match","quantity","setQuantity","rating","setRating","review","setReview","allReviews","setAllReviews","hasOrderedItem","setHasOrderedItem","showReviewForm","setShowReviewForm","dispatch","userLogin","state","userInfo","productDetails","loading","product","error","userDetails","userLoginError","productCreateReview","loadingCreateReview","success","successCreateReview","errorCreateReview","orderListUser","orders","isSocialLogin","id","user","JSON","parse","localStorage","getItem","email","window","alert","type","params","reviews","flag","length","obj","ele","orderItems","toString","sortedArr","sort","a","b","Date","createdAt","handleAddToCart","e","push","handleReviewSubmit","_id","name","image","numReviews","price","toLocaleString","maximumFractionDigits","style","currency","description","countInStock","target","value","Array","keys","map","item","avatar","margin","fontSize"],"mappings":"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","sourcesContent":["/* eslint-disable array-callback-return */\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  Button,\r\n  ListGroup,\r\n  Form,\r\n  FloatingLabel,\r\n} from \"react-bootstrap\";\r\nimport ImageMagnifier from \"../components/ImageMagnifier\"; // to magnify image on hover\r\nimport Rating from \"../components/Rating\";\r\nimport Meta from \"../components/Meta\";\r\nimport Loader from \"../components/Loader\";\r\nimport Message from \"../components/Message\";\r\nimport {\r\n  listProductDetails,\r\n  createProductReview,\r\n} from \"../actions/productActions\";\r\nimport { listMyOrders } from \"../actions/orderActions\";\r\nimport { refreshLogin, getUserDetails } from \"../actions/userActions\";\r\nimport { PRODUCT_CREATE_REVIEW_RESET } from \"../constants/productConstants\";\r\nimport getDateString from \"../utils/getDateString\";\r\nimport \"../styles/product-page.css\";\r\n\r\nconst ProductPage = ({ history, match }) => {\r\n  const [quantity, setQuantity] = useState(1);\r\n  const [rating, setRating] = useState(0);\r\n  const [review, setReview] = useState(\"\");\r\n  const [allReviews, setAllReviews] = useState([]);\r\n  const [hasOrderedItem, setHasOrderedItem] = useState(false); // bool to check if the user has ordered this product\r\n  const [showReviewForm, setShowReviewForm] = useState(false); // bool to decide whether to show the review form or not\r\n  const dispatch = useDispatch();\r\n\r\n  const userLogin = useSelector((state) => state.userLogin);\r\n  const { userInfo } = userLogin;\r\n\r\n  const productDetails = useSelector((state) => state.productDetails);\r\n  const { loading, product, error } = productDetails;\r\n\r\n  const userDetails = useSelector((state) => state.userDetails);\r\n  const { error: userLoginError } = userDetails;\r\n\r\n  const productCreateReview = useSelector((state) => state.productCreateReview);\r\n  const {\r\n    loading: loadingCreateReview,\r\n    success: successCreateReview,\r\n    error: errorCreateReview,\r\n  } = productCreateReview;\r\n\r\n  const orderListUser = useSelector((state) => state.orderListUser);\r\n  const { orders } = orderListUser;\r\n\r\n  // fetch user login info\r\n  useEffect(() => {\r\n    userInfo\r\n      ? userInfo.isSocialLogin\r\n        ? dispatch(getUserDetails(userInfo.id))\r\n        : dispatch(getUserDetails(\"profile\"))\r\n      : dispatch(getUserDetails(\"profile\"));\r\n  }, [userInfo, dispatch]);\r\n\r\n  // refresh the access tokens for accessing user details\r\n  useEffect(() => {\r\n    if (userLoginError && userInfo && !userInfo.isSocialLogin) {\r\n      const user = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n      user && dispatch(refreshLogin(user.email));\r\n    }\r\n  }, [userLoginError, dispatch, userInfo]);\r\n\r\n  useEffect(() => {\r\n    dispatch(listMyOrders());\r\n  }, [dispatch]);\r\n\r\n  // add a new review, and reset the stored product review in the redux store\r\n  useEffect(() => {\r\n    if (successCreateReview) {\r\n      window.alert(\"Review Submitted!!\");\r\n      setRating(0);\r\n      setReview(\"\");\r\n      dispatch({ type: PRODUCT_CREATE_REVIEW_RESET });\r\n    }\r\n    dispatch(listProductDetails(match.params.id));\r\n  }, [match, dispatch, successCreateReview]);\r\n\r\n  useEffect(() => {\r\n    if (product && product.reviews && userInfo) {\r\n      let flag = 0; // to check if this user has already reviewed this product\r\n      for (let review of product.reviews) {\r\n        if (review.user === userInfo.id) {\r\n          flag = 1;\r\n          break;\r\n        }\r\n      }\r\n      flag ? setShowReviewForm(false) : setShowReviewForm(true);\r\n    } else {\r\n      setShowReviewForm(true);\r\n    }\r\n  }, [product, userInfo]);\r\n\r\n  useEffect(() => {\r\n    if (orders && orders.length) {\r\n      let flag = 0; // to check is this user has ordered this item\r\n      for (let obj of orders) {\r\n        for (let ele of obj.orderItems) {\r\n          if (ele.product.toString() === match.params.id) {\r\n            flag = 1;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      flag ? setHasOrderedItem(true) : setHasOrderedItem(false);\r\n    } else {\r\n      setHasOrderedItem(false);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [orders]);\r\n\r\n  // arrange all reviews in reverse chronological order\r\n  useEffect(() => {\r\n    if (product && product.reviews) {\r\n      const sortedArr = product.reviews.sort(\r\n        (a, b) => new Date(b.createdAt) - new Date(a.createdAt)\r\n      );\r\n      setAllReviews(sortedArr);\r\n    }\r\n  }, [product]);\r\n\r\n  const handleAddToCart = (e) => {\r\n    history.push(`/cart/${match.params.id}?qty=${quantity}`);\r\n  };\r\n\r\n  const handleReviewSubmit = (e) => {\r\n    dispatch(\r\n      createProductReview(match.params.id, {\r\n        rating,\r\n        review,\r\n      })\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Link className=\"btn btn-outline-primary my-2\" to=\"/\">\r\n        Go Back\r\n      </Link>\r\n      {product && (!product._id || product._id !== match.params.id) ? (\r\n        <Loader />\r\n      ) : error ? (\r\n        <Message dismissible variant=\"danger\" duration={10}>\r\n          {error}\r\n        </Message>\r\n      ) : product ? (\r\n        <>\r\n          <Meta title={`${product.name}`} />\r\n          <Row>\r\n            <Col md={6}>\r\n              <ImageMagnifier\r\n                src={product.image}\r\n                alt={product.name}\r\n                title={product.name}\r\n              />\r\n            </Col>\r\n            <Col md={3}>\r\n              <ListGroup variant=\"flush\">\r\n                <ListGroup.Item>\r\n                  <h3>{product.name}</h3>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  {product && product.rating && (\r\n                    <Rating\r\n                      value={product.rating}\r\n                      text={`${product.numReviews} Review${\r\n                        product.numReviews > 1 ? \"s\" : \"\"\r\n                      }`}\r\n                    />\r\n                  )}\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <strong>Price: </strong>\r\n                  {product.price &&\r\n                    product.price.toLocaleString(\"en-IN\", {\r\n                      maximumFractionDigits: 2,\r\n                      style: \"currency\",\r\n                      currency: \"USD\",\r\n                    })}\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <strong>Description:</strong> {product.description}\r\n                </ListGroup.Item>\r\n              </ListGroup>\r\n            </Col>\r\n            <Col md={3}>\r\n              <Card>\r\n                <ListGroup variant=\"flush\">\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>\r\n                        <strong>Price: </strong>\r\n                      </Col>\r\n                      <Col>\r\n                        {product.price &&\r\n                          product.price.toLocaleString(\"en-IN\", {\r\n                            maximumFractionDigits: 2,\r\n                            style: \"currency\",\r\n                            currency: \"USD\",\r\n                          })}\r\n                      </Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                </ListGroup>\r\n                <ListGroup variant=\"flush\">\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Col>\r\n                        <strong>Status: </strong>\r\n                      </Col>\r\n                      <Col>\r\n                        {product.countInStock > 0 ? \"In Stock\" : \"Out of Stock\"}\r\n                      </Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                  {product.countInStock > 0 && (\r\n                    <ListGroup.Item>\r\n                      <Row>\r\n                        <Col>\r\n                          <strong>Qty:</strong>\r\n                        </Col>\r\n                        <Col>\r\n                          <Form.Control\r\n                            as=\"select\"\r\n                            value={quantity}\r\n                            onChange={(e) => setQuantity(e.target.value)}\r\n                          >\r\n                            {/* create as many options as the countInStock */}\r\n                            {[...Array(product.countInStock).keys()].map(\r\n                              (ele) => (\r\n                                <option key={ele + 1} value={ele + 1}>\r\n                                  {ele + 1}\r\n                                </option>\r\n                              )\r\n                            )}\r\n                          </Form.Control>\r\n                        </Col>\r\n                      </Row>\r\n                    </ListGroup.Item>\r\n                  )}\r\n                  <ListGroup.Item>\r\n                    <Row>\r\n                      <Button\r\n                        onClick={handleAddToCart}\r\n                        type=\"button\"\r\n                        className=\"btn-block btn-lg\"\r\n                        disabled={product.countInStock <= 0}\r\n                      >\r\n                        Add To Cart\r\n                      </Button>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                </ListGroup>\r\n              </Card>\r\n            </Col>\r\n          </Row>\r\n          <Row>\r\n            <Col md={6}>\r\n              <h2 className=\"mt-3\">Reviews</h2>\r\n              {(!product.reviews || !product.reviews.length) && (\r\n                <Message variant=\"secondary\">No Reviews Yet</Message>\r\n              )}\r\n              <ListGroup variant=\"flush\">\r\n                {/* {console.log(\r\n\t\t\t\t\t\t\t\t\tproduct.reviews.\r\n\t\t\t\t\t\t\t\t)} */}\r\n                {allReviews.map((item) => {\r\n                  return (\r\n                    <ListGroup.Item key={item._id}>\r\n                      <div>\r\n                        <img\r\n                          src={item.avatar}\r\n                          alt={item.name}\r\n                          className=\"review-avatar\"\r\n                        />\r\n                        <strong>{item.name}</strong>\r\n                      </div>\r\n                      <Rating value={item.rating} />\r\n                      <p\r\n                        style={{\r\n                          margin: \"0\",\r\n                          fontSize: \"1.1em\",\r\n                        }}\r\n                      >\r\n                        {item.review}\r\n                      </p>\r\n                      <small\r\n                        style={{\r\n                          fontSize: \"0.9em\",\r\n                        }}\r\n                      >\r\n                        {getDateString(item.createdAt, false)}\r\n                      </small>\r\n                    </ListGroup.Item>\r\n                  );\r\n                })}\r\n                {hasOrderedItem && !showReviewForm && (\r\n                  <Message dismissible>\r\n                    You have already reviewed this product\r\n                  </Message>\r\n                )}\r\n                {hasOrderedItem && showReviewForm && (\r\n                  <>\r\n                    <h2>Write a Customer Review</h2>\r\n                    {errorCreateReview && (\r\n                      <Message dismissible variant=\"info\" duration={10}>\r\n                        {errorCreateReview}\r\n                      </Message>\r\n                    )}\r\n                    {loadingCreateReview && <Loader />}\r\n                    <Form onSubmit={handleReviewSubmit}>\r\n                      <Form.Group controlId=\"rating\">\r\n                        <Form.Control\r\n                          as=\"select\"\r\n                          value={rating}\r\n                          onChange={(e) => setRating(e.target.value)}\r\n                        >\r\n                          <option default>Choose Rating</option>\r\n                          <option value=\"1\">1 - Bad</option>\r\n                          <option value=\"2\">2 - Poor</option>\r\n                          <option value=\"3\">3 - Fair</option>\r\n                          <option value=\"4\">4 - Good</option>\r\n                          <option value=\"5\">5 - Excellent</option>\r\n                        </Form.Control>\r\n                      </Form.Group>\r\n                      <Form.Group controlId=\"comment\">\r\n                        <FloatingLabel\r\n                          controlId=\"commenttext\"\r\n                          label=\"Comment\"\r\n                          className=\"my-3\"\r\n                        >\r\n                          <Form.Control\r\n                            as=\"textarea\"\r\n                            placeholder=\"Leave a comment here\"\r\n                            row=\"3\"\r\n                            onChange={(e) => setReview(e.target.value)}\r\n                            value={review}\r\n                          />\r\n                        </FloatingLabel>\r\n                      </Form.Group>\r\n                      <div className=\"d-grid\">\r\n                        <Button type=\"submit\">Submit Review</Button>\r\n                      </div>\r\n                    </Form>\r\n                  </>\r\n                )}\r\n              </ListGroup>\r\n            </Col>\r\n          </Row>\r\n        </>\r\n      ) : (\r\n        \"\"\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ProductPage;\r\n"]},"metadata":{},"sourceType":"module"}